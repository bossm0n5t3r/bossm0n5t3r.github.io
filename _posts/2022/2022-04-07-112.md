---
title: 'ë¡œì»¬ ê°œë°œì—ì„œ HTTPSë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•'
date: 2022-04-07 00:00:00 +0900
categories: [localhost, https, ngrok, ssh-portforwarding, spring-boot]
tags: [localhost, https, ngrok, ssh-portforwarding, spring-boot]
math: false
mermaid: false
image:
  src: /assets/img/posts/common/development-unsplash.jpeg
---

## ê°œìš”

ë°©ë²•ì€ í¬ê²Œ 3ê°€ì§€ê°€ ìˆëŠ” ê²ƒ ê°™ë‹¤.

1. HTTPS using an internet proxy
2. mkcert + Nginx docker image
3. Configure Spring Boot to use HTTPS using mkcert

## HTTPS using an internet proxy

### `ngrok` ì„ ì´ìš©í•œ ë°©ë²•ì´ë‹¤.

1. [https://ngrok.com/](https://ngrok.com/) ì—ì„œ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤.
2. ì„¤ì¹˜ê°€ í•„ìš”í•˜ë‹¤.
3. ë¬´ë£Œë¡œ ì´ìš©í•  ê²½ìš° ì œí•œì´ ì¡°ê¸ˆ ìˆë‹¤.

~~ê·¸ë˜ì„œ ì•ˆí–ˆë‹¤.~~

### [https://localhost.run/](https://localhost.run/) ì„ ì´ìš©í•œ ë°©ë²•ì´ë‹¤.

1. ì„¤ì¹˜ê°€ ë¶ˆí•„ìš”í•˜ë‹¤.
2. SSH í¬íŠ¸í¬ì›Œë”©ì„ í†µí•´ì„œ ì‚¬ìš©ê°€ëŠ¥í•˜ë‹¤.
3. ìˆœì„œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

   1. ìš°ì„  í„°ë¯¸ë„ì—ì„œ ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰í•´ì¤€ë‹¤.

      ```bash
      ssh -R 80:localhost:8080 localhost.run
      ```

      - cf.) ì›í•œë‹¤ë©´, ë‹¤ë¥¸ í¬íŠ¸ë„ ì„ íƒê°€ëŠ¥í•˜ë‹¤.

   2. ì‹¤í–‰í•˜ë©´ í„°ë¯¸ë„ì— ì•„ë˜ì™€ ê°™ì´ ì ‘ì† ê°€ëŠ¥í•œ ë§í¬ê°€ ëœ¨ê²Œ ëœë‹¤.

      ```bash
      ...
      ===============================================================================

      ** your connection id is c76ffccd-6b1b-4149-b9b9-7d8478e3e5bd, please mention it if you send me a message about an issue. **

      cda0814b3d6062.lhrtunnel.link tunneled with tls termination, https://cda0814b3d6062.lhrtunnel.link
      ```

   3. ì„œë²„ë¥¼ ì‹¤í–‰í•˜ê³ , ì ‘ì†í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì˜ ë³´ì´ê²Œ ëœë‹¤.

      ![1.png](/assets/img/posts/112/1.png)

      ![2.png](/assets/img/posts/112/2.png)

   - í„°ë¯¸ë„ì„ ì¢…ë£Œí•˜ê³  ë‹¤ì‹œ ì‹¤í–‰í•´ë„ ê°™ì€ urlë¡œ ëœ¬ë‹¤.
   - ìì„¸í•œ ë‚´ìš©ì€ docë¥¼ ì°¸ê³ í•˜ì.

---

- ì´ëŸ¬í•œ íˆ´ì˜ ëª©ì ì€ ë¡œì»¬ ê°œë°œì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê³µê°œ URLì„ ì œê³µí•˜ëŠ” ê²ƒì´ë‹¤.
- ì´ URLì€ ì¸í„°ë„·ì„ í†µí•´ ë¬´ì–¸ê°€ë¥¼ ê³µìœ í•˜ê³  ì‹¶ì€ ê²½ìš°ì— ë§¤ìš° ì í•©í•˜ë‹¤.
- ê³µìœ í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ê°œë°œ ë¨¸ì‹ ì„ ì ì¬ì ì¸ ì˜¨ë¼ì¸ ê³µê²©ìì—ê²Œ ë…¸ì¶œì‹œí‚¤ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ë‹¤.
- ë‹¤ìŒ ë‘ ê°€ì§€ ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ì´ ë¬¸ì œë¥¼ ë°©ì§€ ê°€ëŠ¥í•˜ë‹¤.

## `mkcert` + Nginx docker image

1. `mkcert`ë¥¼ ì´ìš©í•´ì„œ ì¸ì¦ì„œë¥¼ ì„¤ì¹˜í•œ ë‹¤ìŒ
2. `docker`ë¥¼ ì´ìš©í•´ì„œ ë„ìš¸ ë•Œ ì¸ì¦ì„œë¥¼ ê°€ì ¸ë‹¤ê°€ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤.
3. ê·€ì°®ì•„ì„œ ì•ˆí•´ë´¤ë‹¤.

## Configure Spring Boot to use HTTPS using `mkcert`

1. ì‚¬ì‹¤ ì œì¼ ê°„ë‹¨í•˜ê³  ë°”ë¡œ ì ìš©í•´ë³¼ ìˆ˜ ìˆëŠ” ê²ƒ ê°™ì•„ì„œ ì§ì ‘ í•´ë´¤ë‹¤.
2. ìš°ì„  `mkcert` ë¶€í„° ì„¤ì¹˜í•´ì£¼ì.

   - [https://github.com/FiloSottile/mkcert#installation](https://github.com/FiloSottile/mkcert#installation)

   ```bash
   brew install mkcert
   brew install nss # if you use Firefox

   ë¡œì»¬ ë£¨íŠ¸ CAì— mkcertë¥¼ ì¶”ê°€í•˜ì.
   ```

3. ë¡œì»¬ ë£¨íŠ¸ CAì— `mkcert`ë¥¼ ì¶”ê°€í•˜ì.

   ```bash
   $ mkcert -install
   Created a new local CA ğŸ’¥
   Sudo password:
   The local CA is now installed in the system trust store! âš¡ï¸
   The local CA is now installed in Java's trust store! â˜•ï¸
   ```

4. `.config` ì•„ë˜ì— ë””ë ‰í„°ë¦¬ë¥¼ í•˜ë‚˜ë§Œë“¤ì–´ì£¼ì.

   ```bash
   # create the directory
   mkdir -p ~/.config/spring-boot
   ```

5. pkcs12 format ì¸ì¦ì„œë¥¼ í•´ë‹¹ ë””ë ‰í„°ë¦¬ ë°‘ì— ìƒì„±í•´ì£¼ì.

   ```bash
   $ mkcert -pkcs12 -p12-file ~/.config/spring-boot/local-tls.p12 localhost

   Created a new certificate valid for the following names ğŸ“œ
    - "localhost"

   The PKCS#12 bundle is at "/Users/bossm0n5t3r/.config/spring-boot/local-tls.p12" âœ…

   The legacy PKCS#12 encryption password is the often hardcoded default "changeit" â„¹ï¸

   It will expire on 3 July 2024 ğŸ—“
   ```

6. `~/.config/spring-boot/spring-boot-devtools.yaml` íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ìƒì„±í•´ì£¼ì.

   - `.yaml` ì´ ì•„ë‹ˆë¼ `.properties`ë¡œ í•´ë„ ìƒê´€ì—†ë‹¤.
     - ë¬¼ë¡  ì´ëŸ´ ê²½ìš°, ì•„ë˜ í¬ë§·ì„ ë§ê²Œ ìˆ˜ì •í•´ì¤˜ì•¼ í•œë‹¤.
     - [https://developer.okta.com/blog/2022/01/31/local-https-java#configure-spring-boot-to-use-https](https://developer.okta.com/blog/2022/01/31/local-https-java#configure-spring-boot-to-use-https) ì—ì„œëŠ” `.properties` ë¡œ ì§„í–‰í–ˆìœ¼ë‹ˆ ì°¸ê³ í•˜ë©´ ëœë‹¤.

   ```yaml
   server:
     port: 8443 # Set the port
     ssl:
       key-store: ${user.home}/.config/spring-boot/local-tls.p12 # configure the key store path
   ```

7. `Intellij CE` ì—ì„œ ì„¤ì •í•´ì£¼ì.

   1. `Spring Boot DevTools` ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ë³„ë‹¤ë¥¸ ì„¤ì •ì„ í•´ì¤„ í•„ìš”ê°€ ì—†ë‹¤ê³  í•œë‹¤.
      1. ì´ ë§ì¸ ì¦‰ìŠ¨, í•„ìëŠ” ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ í–ˆë‹¤.
   2. `Run Configuration` ì˜ `Environment variables`ì— ë‹¤ìŒê³¼ ê°™ì´ ì¶”ê°€í•´ì£¼ë©´ ëœë‹¤.

      1. ì´ì „ì˜ ì„¤ì • ê°’ì´ ìˆë‹¤ë©´, `;` ë¡œ êµ¬ë¶„í•´ì£¼ë©´ ëœë‹¤.

      ```yaml
      SPRING_CONFIG_IMPORT=${user.home}/.config/spring-boot/spring-boot-devtools.yaml
      ```

   ![3.png](/assets/img/posts/112/3.png)

8. ì˜ ì ìš©ëœ ê²ƒ ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

   ![4.png](/assets/img/posts/112/4.png)

## References

- [https://developer.okta.com/blog/2022/01/31/local-https-java](https://developer.okta.com/blog/2022/01/31/local-https-java)
- [https://web.dev/i18n/ko/how-to-use-local-https/](https://web.dev/i18n/ko/how-to-use-local-https/)
- [https://sogoagain.github.io/2020/12/04/mkcertë¥¼-ì´ìš©í•œ-localhost-HTTPS-TLS-ì„¤ì •/](https://sogoagain.github.io/2020/12/04/mkcert%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-localhost-HTTPS-TLS-%EC%84%A4%EC%A0%95/)
- [https://shekhargulati.com/2019/01/19/enabling-https-for-local-spring-boot-development-with-mkcert/](https://shekhargulati.com/2019/01/19/enabling-https-for-local-spring-boot-development-with-mkcert/)
